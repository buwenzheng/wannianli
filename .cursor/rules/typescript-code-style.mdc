# TypeScript ä»£ç æ ¼å¼è§„èŒƒ

## é¡¹ç›®ä»£ç é£æ ¼æ¦‚è¿°

ä¸‡å¹´å†é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„TypeScriptä»£ç é£æ ¼ï¼Œå¼ºè°ƒç®€æ´æ€§å’Œå¯è¯»æ€§ã€‚

### æ ¸å¿ƒåŸåˆ™
- âœ… **æ— åˆ†å·é£æ ¼** - é™¤å¿…è¦æƒ…å†µå¤–ä¸ä½¿ç”¨åˆ†å·
- âœ… **ç±»å‹æ˜ç¡®** - æ‰€æœ‰å‡½æ•°å¿…é¡»æ˜ç¡®è¿”å›ç±»å‹
- âœ… **æ ¼å¼ä¸€è‡´** - ä½¿ç”¨Prettierè‡ªåŠ¨æ ¼å¼åŒ–
- âœ… **å‘½åè§„èŒƒ** - éµå¾ªTypeScriptæœ€ä½³å®è·µ

## å‡½æ•°è¿”å›ç±»å‹è§„èŒƒ

### âš ï¸ å¼ºåˆ¶è¦æ±‚ï¼šæ‰€æœ‰å‡½æ•°å¿…é¡»æ˜ç¡®è¿”å›ç±»å‹

#### 1. Reactç»„ä»¶
```typescript
// âœ… æ­£ç¡® - æ˜ç¡®è¿”å›ç±»å‹
const Calendar: React.FC<CalendarProps> = ({ onDateSelect }): React.JSX.Element => {
  return <div>...</div>
}

// âœ… æ­£ç¡® - å‡½æ•°ç»„ä»¶
function App(): React.JSX.Element {
  return <div>...</div>
}

// âŒ é”™è¯¯ - ç¼ºå°‘è¿”å›ç±»å‹
const Calendar = ({ onDateSelect }) => {
  return <div>...</div>
}
```

#### 2. äº‹ä»¶å¤„ç†å‡½æ•°
```typescript
// âœ… æ­£ç¡® - æ˜ç¡®voidè¿”å›ç±»å‹
const handleDateSelect = (date: Date): void => {
  setSelectedDate(date)
  console.log('é€‰æ‹©çš„æ—¥æœŸ:', date)
}

// âœ… æ­£ç¡® - å¸¦è¿”å›å€¼çš„å‡½æ•°
const formatDate = (date: Date): string => {
  return dayjs(date).format('YYYY-MM-DD')
}

// âŒ é”™è¯¯ - ç¼ºå°‘è¿”å›ç±»å‹
const handleDateSelect = (date: Date) => {
  setSelectedDate(date)
}
```

#### 3. å·¥å…·å‡½æ•°
```typescript
// âœ… æ­£ç¡® - æ˜ç¡®è¿”å›ç±»å‹
export function getCalendarDates(date: Date): Date[] {
  const currentMonth = dayjs(date)
  return dates
}

// âœ… æ­£ç¡® - å¸ƒå°”è¿”å›å€¼
export function isToday(date: Date): boolean {
  return dayjs(date).isSame(dayjs(), 'day')
}

// âœ… æ­£ç¡® - æ³›å‹å‡½æ•°
export function cn(...inputs: ClassValue[]): string {
  return clsx(inputs)
}
```

#### 4. Hookå‡½æ•°
```typescript
// âœ… æ­£ç¡® - æ˜ç¡®Hookè¿”å›ç±»å‹
export function useCalendar({
  initialDate = new Date(),
  events = [],
  showLunar = true
}: UseCalendarProps = {}): UseCalendarReturn {
  // Hookå®ç°
  return {
    currentMonth,
    selectedDate,
    calendarDates,
    goToPrevMonth,
    goToNextMonth,
    goToToday,
    selectDate,
    setCurrentMonth
  }
}
```

## æ¥å£å’Œç±»å‹å®šä¹‰è§„èŒƒ

### 1. æ— åˆ†å·é£æ ¼
```typescript
// âœ… æ­£ç¡® - æ— åˆ†å·æ¥å£å®šä¹‰
export interface CalendarDate {
  date: Date
  day: number
  isToday: boolean
  isCurrentMonth: boolean
  isSelected: boolean
  lunarInfo?: {
    lunarDate: string
    festival?: string
    solarTerm?: string
  }
  events?: CalendarEvent[]
}

// âŒ é”™è¯¯ - å¸¦åˆ†å·ï¼ˆæ—§é£æ ¼ï¼‰
export interface CalendarDate {
  date: Date;
  day: number;
  isToday: boolean;
}
```

### 2. å‡½æ•°ç±»å‹å®šä¹‰
```typescript
// âœ… æ­£ç¡® - æ— åˆ†å·å‡½æ•°ç±»å‹
export interface CalendarProps {
  currentDate?: Date
  selectedDate?: Date
  onDateSelect?: (date: Date) => void
  onMonthChange?: (date: Date) => void
  showLunar?: boolean
  events?: CalendarEvent[]
}

// âœ… æ­£ç¡® - å¤æ‚å‡½æ•°ç±»å‹
type EventHandler<T> = (event: T) => void
type AsyncDataFetcher<T> = (id: string) => Promise<T>
```

## JSX/TSX æ ¼å¼è§„èŒƒ

### 1. ç»„ä»¶å±æ€§æ ¼å¼
```typescript
// âœ… æ­£ç¡® - ç®€æ´çš„å•è¡Œå±æ€§
<Calendar onDateSelect={handleDateSelect} showLunar={true} />

// âœ… æ­£ç¡® - å¤šè¡Œå±æ€§ï¼ˆå±æ€§è¾ƒå¤šæ—¶ï¼‰
<Calendar
  onDateSelect={handleDateSelect}
  onMonthChange={handleMonthChange}
  showLunar={true}
  events={events}
/>

// âœ… æ­£ç¡® - æ¡ä»¶æ¸²æŸ“
{dateInfo.lunarInfo?.festival && <div className="festival-dot" />}

// âœ… æ­£ç¡® - ç´§å‡‘çš„å†…å®¹
<span className="text-sm font-medium">{dateInfo.day}</span>
```

### 2. å¾ªç¯æ¸²æŸ“
```typescript
// âœ… æ­£ç¡® - ç®­å¤´å‡½æ•°å‚æ•°åŠ æ‹¬å·
{weekDays.map((day) => (
  <div key={day} className="day-header">
    {day}
  </div>
))}

// âœ… æ­£ç¡® - å¤æ‚æ¸²æŸ“é€»è¾‘
{dates.map((dateInfo, index) => (
  <div
    key={index}
    onClick={() => onDateClick(dateInfo.date)}
    className={cn(
      'calendar-cell',
      dateInfo.isToday && 'today',
      dateInfo.isSelected && 'selected'
    )}
  >
    <span>{dateInfo.day}</span>
  </div>
))}
```

## å¯¼å…¥å¯¼å‡ºè§„èŒƒ

### 1. å¯¼å…¥è¯­å¥
```typescript
// âœ… æ­£ç¡® - å‘½åå¯¼å…¥
import { useState, useMemo } from 'react'
import { CalendarDate, CalendarEvent } from '../types/calendar'

// âœ… æ­£ç¡® - é»˜è®¤å¯¼å…¥
import dayjs from 'dayjs'
import CalendarHeader from './CalendarHeader'

// âœ… æ­£ç¡® - æ··åˆå¯¼å…¥
import React, { useState, useEffect } from 'react'

// âœ… æ­£ç¡® - ç±»å‹å¯¼å…¥ï¼ˆä»…ç±»å‹ï¼‰
import type { CalendarProps } from '../types/calendar'
```

### 2. å¯¼å‡ºè¯­å¥
```typescript
// âœ… æ­£ç¡® - é»˜è®¤å¯¼å‡º
export default Calendar

// âœ… æ­£ç¡® - å‘½åå¯¼å‡º
export { Calendar, CalendarGrid, CalendarHeader }

// âœ… æ­£ç¡® - ç±»å‹å¯¼å‡º
export type { CalendarProps, CalendarDate, CalendarEvent, CalendarState }

// âœ… æ­£ç¡® - é‡æ–°å¯¼å‡º
export * from './Calendar'
```

## ESLint é…ç½®è¦æ±‚

### å¿…é¡»å¯ç”¨çš„è§„åˆ™
```javascript
// eslint.config.mjs
export default [
  {
    rules: {
      // å¼ºåˆ¶å‡½æ•°è¿”å›ç±»å‹
      '@typescript-eslint/explicit-function-return-type': 'error',
      
      // ç¦ç”¨åˆ†å·
      'semi': ['error', 'never'],
      '@typescript-eslint/semi': ['error', 'never'],
      
      // å¼ºåˆ¶ä½¿ç”¨const
      'prefer-const': 'error',
      
      // ç¦ç”¨anyç±»å‹
      '@typescript-eslint/no-explicit-any': 'error',
      
      // æœªä½¿ç”¨å˜é‡è­¦å‘Š
      '@typescript-eslint/no-unused-vars': 'warn',
      
      // Reactç›¸å…³
      'react/jsx-uses-react': 'off', // React 17+
      'react/react-in-jsx-scope': 'off', // React 17+
    }
  }
]
```

## Prettier é…ç½®è¦æ±‚

### .prettierrc.yaml
```yaml
# é¡¹ç›®Prettieré…ç½®
semi: false                 # æ— åˆ†å·
singleQuote: true          # å•å¼•å·
tabWidth: 2                # 2ç©ºæ ¼ç¼©è¿›
trailingComma: 'none'      # æ— å°¾éšé€—å·
printWidth: 100            # è¡Œé•¿åº¦é™åˆ¶
bracketSpacing: true       # å¯¹è±¡æ‹¬å·ç©ºæ ¼
arrowParens: 'always'      # ç®­å¤´å‡½æ•°å‚æ•°æ‹¬å·
endOfLine: 'lf'           # æ¢è¡Œç¬¦
```

## å‘½åè§„èŒƒ

### 1. å˜é‡å’Œå‡½æ•°
```typescript
// âœ… æ­£ç¡® - camelCase
const selectedDate = new Date()
const handleDateSelect = (date: Date): void => {}
const isCurrentMonth = (date: Date): boolean => {}

// âŒ é”™è¯¯ - å…¶ä»–æ ¼å¼
const selected_date = new Date()
const HandleDateSelect = () => {}
```

### 2. å¸¸é‡
```typescript
// âœ… æ­£ç¡® - UPPER_SNAKE_CASE
const MAX_CALENDAR_WEEKS = 6
const DEFAULT_LOCALE = 'zh-CN'

// âœ… æ­£ç¡® - å¯¹è±¡å¸¸é‡ä½¿ç”¨camelCase
const calendarConfig = {
  weekStartsOn: 0,
  showWeekNumbers: false
} as const
```

### 3. ç»„ä»¶å’Œç±»å‹
```typescript
// âœ… æ­£ç¡® - PascalCase
interface CalendarProps {}
type CalendarState = {}
class DateUtils {}
const Calendar: React.FC = () => {}

// âœ… æ­£ç¡® - æ³›å‹
interface ApiResponse<T> {}
type EventHandler<TEvent> = (event: TEvent) => void
```

## æ–‡ä»¶ç»„ç»‡è§„èŒƒ

### 1. æ–‡ä»¶å†…éƒ¨ç»“æ„
```typescript
// 1. å¯¼å…¥è¯­å¥ï¼ˆæŒ‰ç±»å‹åˆ†ç»„ï¼‰
import React, { useState, useMemo } from 'react'
import dayjs from 'dayjs'

import { CalendarDate } from '../types/calendar'
import { getCalendarDates } from '../utils/dateUtils'
import CalendarHeader from './CalendarHeader'

// 2. ç±»å‹å®šä¹‰ï¼ˆå¦‚æœæ˜¯æœ¬åœ°çš„ï¼‰
interface LocalComponentProps {
  // ...
}

// 3. å¸¸é‡å®šä¹‰
const DEFAULT_VIEW_MODE = 'month'

// 4. ä¸»è¦ç»„ä»¶æˆ–å‡½æ•°
const Calendar: React.FC<CalendarProps> = (): React.JSX.Element => {
  // ...
}

// 5. é»˜è®¤å¯¼å‡º
export default Calendar
```

### 2. æ³¨é‡Šè§„èŒƒ
```typescript
/**
 * è·å–æœˆä»½çš„æ‰€æœ‰æ—¥æœŸï¼ˆåŒ…æ‹¬å‰åæœˆä»½çš„å¡«å……æ—¥æœŸï¼‰
 * ç”Ÿæˆæ—¥å†ç½‘æ ¼éœ€è¦çš„42ä¸ªæ—¥æœŸï¼ˆ6å‘¨ Ã— 7å¤©ï¼‰
 */
export function getCalendarDates(date: Date): Date[] {
  // å®ç°é€»è¾‘
}

/**
 * æ—¥å†ç»„ä»¶å±æ€§æ¥å£
 */
export interface CalendarProps {
  /** å½“å‰æ˜¾ç¤ºçš„æ—¥æœŸ */
  currentDate?: Date
  /** æ—¥æœŸé€‰æ‹©å›è°ƒå‡½æ•° */
  onDateSelect?: (date: Date) => void
}
```

## é”™è¯¯å¤„ç†è§„èŒƒ

### 1. ç±»å‹å®‰å…¨çš„é”™è¯¯å¤„ç†
```typescript
// âœ… æ­£ç¡® - ä½¿ç”¨Resultç±»å‹
type Result<T> = 
  | { success: true; data: T }
  | { success: false; error: string }

export function safeParseDate(dateString: string): Result<Date> {
  try {
    const date = new Date(dateString)
    if (isNaN(date.getTime())) {
      return { success: false, error: 'Invalid date string' }
    }
    return { success: true, data: date }
  } catch (error) {
    return { 
      success: false, 
      error: error instanceof Error ? error.message : 'Unknown error' 
    }
  }
}
```

## æ€§èƒ½ä¼˜åŒ–è§„èŒƒ

### 1. Reactä¼˜åŒ–
```typescript
// âœ… æ­£ç¡® - useMemoä¼˜åŒ–
const calendarDates = useMemo((): CalendarDate[] => {
  return getCalendarDates(currentMonth).map((date): CalendarDate => ({
    date,
    day: date.getDate(),
    isToday: isToday(date),
    isCurrentMonth: isCurrentMonth(date, currentMonth)
  }))
}, [currentMonth, selectedDate])

// âœ… æ­£ç¡® - useCallbackä¼˜åŒ–
const handleDateSelect = useCallback((date: Date): void => {
  setSelectedDate(date)
  onDateSelect?.(date)
}, [onDateSelect])
```

## å¼€å‘å·¥å…·é…ç½®

### VS Code è®¾ç½®å»ºè®®
```json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.preferences.includePackageJsonAutoImports": "on",
  "typescript.suggest.autoImports": true
}
```

## ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•

### âœ… æäº¤å‰æ£€æŸ¥
- [ ] æ‰€æœ‰å‡½æ•°éƒ½æœ‰æ˜ç¡®çš„è¿”å›ç±»å‹
- [ ] æ²¡æœ‰ä½¿ç”¨åˆ†å·ï¼ˆé™¤éå¿…è¦ï¼‰
- [ ] æ¥å£å®šä¹‰ä½¿ç”¨æ— åˆ†å·æ ¼å¼
- [ ] å˜é‡å’Œå‡½æ•°ä½¿ç”¨camelCaseå‘½å
- [ ] ç»„ä»¶å’Œç±»å‹ä½¿ç”¨PascalCaseå‘½å
- [ ] å¯¼å…¥è¯­å¥æŒ‰ç±»å‹åˆ†ç»„
- [ ] æ²¡æœ‰ä½¿ç”¨anyç±»å‹
- [ ] æ‰€æœ‰å¼‚æ­¥å‡½æ•°éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
- [ ] Reactç»„ä»¶ä½¿ç”¨æ­£ç¡®çš„ç±»å‹å®šä¹‰

### ğŸ”§ è‡ªåŠ¨åŒ–æ£€æŸ¥
```bash
# è¿è¡Œæ£€æŸ¥å‘½ä»¤
npm run lint          # ESLintæ£€æŸ¥
npm run format        # Prettieræ ¼å¼åŒ–
npm run typecheck     # TypeScriptç±»å‹æ£€æŸ¥
```

è®°ä½ï¼š**ä¸€è‡´çš„ä»£ç é£æ ¼æ¯”ç‰¹å®šçš„é£æ ¼é€‰æ‹©æ›´é‡è¦**ã€‚éµå¾ªè¿™äº›è§„èŒƒå¯ä»¥ç¡®ä¿æ•´ä¸ªå›¢é˜Ÿçš„ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œå‡å°‘ä»£ç å®¡æŸ¥ä¸­çš„æ ¼å¼äº‰è®®ã€‚